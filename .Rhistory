collatedata(decache = TRUE)
fip_token(decache = 'all')
devtools::load_all(".")
library(fwtraits)
# Define working directory
wdir <- "C:\\Users\\anthbasooma\\Documents\\Anthony\\PhD\\AuaINFRA\\FD2"
# Set defined working directory
setwd(wdir)
# Create a directory to store all the data of the case study
dir.create("data")
# Load libraries
library(hydrographr)
library(terra)
library(sf)
library(rgbif)
library(data.table)
library(dplyr)
library(stringr)
library(purrr)
library(forcats)
library(leaflet)
library(ggplot2)
gbif_data <- occ_data(scientificName = "Conorhynchos conirostris",
hasCoordinate = TRUE)
spdata <- gbif_data$data %>%
select(decimalLongitude, decimalLatitude, species, occurrenceStatus,
country, year) %>%
filter(!is.na(year)) %>%
distinct() %>%
mutate(occurence_id = 1:nrow(.)) %>%
rename("longitude" = "decimalLongitude",
"latitude" = "decimalLatitude") %>%
select(7, 1:6)
# Get the tile IDs where the points are located
tile_id <- get_tile_id(data = spdata, lon = "longitude", lat = "latitude")
# Get the tile IDs where the points are located
tile_id <- get_tile_id(data = spdata, lon = "longitude", lat = "latitude")
url= https://public.igb-berlin.de/index.php/s/agciopgzXjWswF4/download?path=%2Fglobal&files=regional_unit_ovr.tif
url= https:/public.igb-berlin.de/index.php/s/agciopgzXjWswF4/download?path=%2Fglobal&files=regional_unit_ovr.tif
url= https:\\public.igb-berlin.de\\index.php\\s\\agciopgzXjWswF4\\download?path=%2Fglobal&files=regional_unit_ovr.tif
url= https:/public.igb-berlin.de/index.php/s/agciopgzXjWswF4/download?path=%2Fglobal&files=regional_unit_ovr.tif
nimbus_url_base <- "https://public.igb-berlin.de/index.php/s/agciopgzXjWswF4/download?path=%2F"
nimbus_url_full <- paste0(nimbus_url_base, "global&files=regional_unit_ovr.tif")
nimbus_url_full
download.file(url = nimbus_url_full)
download.file(url = nimbus_url_full, destfile = tempdir())
gdrive_url_base <- "https://drive.google.com/uc?export=download&id="
gdrive_url_full <- paste0(gdrive_url_base, "1ykV0jRCglz-_fdc4CJDMZC87VMsxzXE4&confirm=t")
download.file(url = gdrive_url_full, destfile = tempdir())
download.file(url = gdrive_url_full, destfile = file.path(getwd(), 'regional.itifn.tif'), mode = 'wb',
cacheOK = TRUE)
download.file(url = nimbus_url_full, destfile = file.path(getwd(), 'regional.itifn.tif'), mode = 'wb',
cacheOK = TRUE)
download.file(url = nimbus_url_full, destfile = file.path(getwd(), 'regional.itifn.tif'), mode = 'wb',
cacheOK = TRUE)
gdrive_url_base <- "https://drive.google.com/uc?export=download&id="
gdrive_url_full <- paste0(gdrive_url_base, "1ykV0jRCglz-_fdc4CJDMZC87VMsxzXE4&confirm=t")
download.file(url = gdrive_url_full, destfile = file.path(getwd(), 'regional.itifn.tif'), mode = 'wb',
cacheOK = TRUE)
utl <- "https://public.igb-berlin.de/index.php/s/agciopgzXjWswF4/download?path=%2Fglobal&files=regional_unit_ovr.tif"
download.file(url = utl, destfile = file.path(getwd(), 'regional.itifn.tif'), mode = 'wb',
cacheOK = TRUE)
nimbus_url_base <- "https://public.igb-berlin.de/index.php/s/agciopgzXjWswF4/download?path=%2F"
nimbus_url_full <- paste0(nimbus_url_base, "global&files=regional_unit_ovr.tif")
download.file(url = nimbus_url_full, destfile = file.path(getwd(), 'regional.itifn.tif'), mode = 'wb',
cacheOK = TRUE)
gdrive_url_base <- "https://drive.google.com/uc?export=download&id="
gdrive_url_full <- paste0(gdrive_url_base, "1ykV0jRCglz-_fdc4CJDMZC87VMsxzXE4&confirm=t")
download.file(url = gdrive_url_full, destfile = file.path(getwd(), 'regional.itifn.tif'), mode = 'wb',
cacheOK = TRUE)
dir <- "C:/Users/anthbasooma/Documents/Anthony/PhD/AuaINFRA/apitesting/testing api"
setwd(dir)
tokendata <- fip_token(seed = 1134)
library(fwtraits)
tokendata <- fip_token(seed = 1134)
fishsppdata <- read.csv(file = 'BF_spec_occ_all_V03_new.csv')
View(fishsppdata)
danube_native <- fip_traits(data = fishsppdata, taxa = 'fi', spcol = 'scientificName', ecotraits = 'catchment region',
token = tokendata)
View(danube_native)
danube_native <- fip_traits(data = fishsppdata, taxa = 'fi', spcol = 'scientificName', ecotraits = 'catchment region',
token = tokendata, merge = TRUE)
danube_native <- fip_traits(data = fishsppdata, taxa = 'fi', spcol = 'scientificName', ecotraits = 'catchment region',
token = tokendata, descvalue = 'Danu')
View(danube_native)
danube_native <- fip_traits(data = fishsppdata, taxa = 'fi', spcol = 'scientificName', ecotraits = 'catchment region',
token = tokendata, descvalue = 'Danu', selectvalue = 'n')
View(fishsppdata)
#if(any(!is.null(selectvalue) | !is.null(descvalue))) {
colnames(fishsppdata)
tdf <- fishsppdata[fishsppdata[, "scientificName"] %in% "Salmo trutta fario" | fishsppdata[, "waterBody"] %in% Usk, ]
tdf <- fishsppdata[fishsppdata[, "scientificName"] %in% "Salmo trutta fario" | fishsppdata[, "waterBody"] %in% "Usk", ]
View(tdf)
tdf <- fishsppdata[fishsppdata[, "scientificName"] %in% "Salmo trutta fario" & fishsppdata[, "waterBody"] %in% "Usk", ]
selectvalue <- NULL
descvalue <- NULL
if(!is.null(selectvalue) & !is.null(descvalue)) {
tdf <- fishsppdata[sname%in% selectvalue &  wname%in% descvalue, ]
}else{
print(here)
}
selectvalue <- NULL
descvalue <- NULL
if(!is.null(selectvalue) & !is.null(descvalue)) {
tdf <- fishsppdata[sname%in% selectvalue &  wname%in% descvalue, ]
}else{
print("here")
}
selectvalue <- NULL
descvalue <- 'Usk'
if(!is.null(selectvalue) & !is.null(descvalue)) {
tdf <- fishsppdata[sname%in% selectvalue &  wname%in% descvalue, ]
}else if(any(!is.null(selectvalue) & !is.null(descvalue))){
print('here')
tdf <- fishsppdata[sname%in% selectvalue &  wname%in% descvalue, ]
}
sname <- fishsppdata[, "scientificName"]
wname <- fishsppdata[, "waterBody"]
selectvalue <- NULL
descvalue <- 'Usk'
if(!is.null(selectvalue) & !is.null(descvalue)) {
tdf <- fishsppdata[sname%in% selectvalue &  wname%in% descvalue, ]
}else if(any(!is.null(selectvalue) & !is.null(descvalue))){
print('here')
tdf <- fishsppdata[sname%in% selectvalue &  wname%in% descvalue, ]
}
selectvalue <- NULL
descvalue <- 'Usk'
if(!is.null(selectvalue) & !is.null(descvalue)) {
tdf <- fishsppdata[sname%in% selectvalue &  wname%in% descvalue, ]
}else if(any(!is.null(selectvalue) | !is.null(descvalue))){
print('here')
tdf <- fishsppdata[sname%in% selectvalue &  wname%in% descvalue, ]
}
tdf <- fishsppdata[fishsppdata[, "scientificName"] %in% NULL |  fishsppdata[, "waterBody"]%in% 'Usk', ]
View(tdf)
dir <- "C:/Users/anthbasooma/Documents/Anthony/PhD/AuaINFRA/apitesting/testing api"
setwd(dir)
library(fwtraits)
tokendata <- fip_token(seed = 1134)
#call data
fishsppdata <- read.csv(file = 'BF_spec_occ_all_V03_new.csv')
#get the species endemic in the danube
danube_native <- fip_traits(data = fishsppdata, taxa = 'fi', spcol = 'scientificName', ecotraits = 'catchment region',
token = tokendata, descvalue = 'Danu', selectvalue = 'n')
dir <- "C:/Users/anthbasooma/Documents/Anthony/PhD/AuaINFRA/apitesting/testing api"
setwd(dir)
library(fwtraits)
tokendata <- fip_token(seed = 1134)
#call data
fishsppdata <- read.csv(file = 'BF_spec_occ_all_V03_new.csv')
#get the species endemic in the danube
danube_native <- fip_traits(data = fishsppdata, taxa = 'fi', spcol = 'scientificName', ecotraits = 'catchment region',
token = tokendata, descvalue = 'Danu', selectvalue = 'n')
tokendata <- fip_token(seed = 1134)
dir <- "C:/Users/anthbasooma/Documents/Anthony/PhD/AuaINFRA/apitesting/testing api"
setwd(dir)
library(fwtraits)
tokendata <- fip_token(seed = 1134)
#call data
fishsppdata <- read.csv(file = 'BF_spec_occ_all_V03_new.csv')
#get the species endemic in the danube
danube_native <- fip_traits(data = fishsppdata, taxa = 'fi', spcol = 'scientificName', ecotraits = 'catchment region',
token = tokendata, descvalue = 'Danu', selectvalue = 'n')
View(danube_native)
danube_native <- fip_traits(data = fishsppdata, taxa = 'fi', spcol = 'scientificName', ecotraits = 'catchment region',
token = tokendata, descvalue = 'Danu', selectvalue = 'A')
danube_native <- fip_traits(data = fishsppdata, taxa = 'fi', spcol = 'scientificName', ecotraits = 'catchment region',
token = tokendata, descvalue = 'Danu', selectvalue = 'a')
View(danube_native)
danube_native <- fip_traits(data = fishsppdata, taxa = 'fi', spcol = 'scientificName', ecotraits = c('catchment region', 'migrhation'),
token = tokendata, descvalue = 'Danu')
View(danube_native)
danube_native <- fip_traits(data = fishsppdata, taxa = 'fi', spcol = 'scientificName', ecotraits = c('catchment region', 'migration'),
token = tokendata, descvalue = 'Danu')
View(danube_native)
danube_native <- fip_traits(data = fishsppdata, taxa = 'fi', spcol = 'scientificName', ecotraits = c('catchment region', 'migration'),
token = tokendata)
View(danube_native)
View(fishsppdata)
danube_native <- fip_traits(data = fishsppdata, taxa = 'fi', spcol = 'scientificName',
ecotraits = c('catchment region', 'migration'),
token = tokendata)
View(danube_native)
danube_native <- fip_traits(data = fishsppdata, taxa = 'fi', spcol = 'scientificName',
ecotraits = c('catchment region', 'migration'),
token = tokendata)
danube_native <- fip_traits(data = fishsppdata, taxa = 'fi', spcol = 'scientificName',
ecotraits = c('catchment region', 'migration'),
token = tokendata, descvalue = 'a')
traits <- traitguide()
View(danube_native)
